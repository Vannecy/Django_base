<style>
    /* Ajoutez votre style CSS ici */
    .mailbox {
        background-color: #f5f5f5;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 20px;
    }

    .message-list {
        list-style: none;
        padding: 0;
    }

    .message-table {
        width: 100%;
        border-collapse: collapse;
    }

    .message-table th,
    .message-table td {
        padding: 10px;
        border: 1px solid #ddd;
    }

    .message-table th {
        background-color: #f0f8ff;
        font-weight: bold;
    }

    .message-table tr {
        cursor: pointer;
    }

    .message-table tr:hover {
        background-color: #f0f8ff; /* Couleur de fond au survol */
    }

    .unread-message {
        background-color: #aaa0a0; /* Rose pour les messages non lus */
    }

    .message-link {
        color: inherit;
        text-decoration: none;
    }

    .selected-message {
        background-color: #f0f8ff;
    }
    .new-message-button {
        display: inline-block;
        background-color: #3498db;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        margin-bottom: 10px;
    }

    .new-message-button:hover {
        background-color: #2980b9;
    }

    .delete-button {
        display: inline-block;
        background-color: #e21d1d;
        color: white;
        padding: 5px 10px;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        margin-bottom: 10px;
    }

    .delete-button:hover {
        background-color: #b31b01;
    }
     /* Style pour centrer la boîte de confirmation */
    .confirm-dialog {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #fff;
        padding: 20px;
        border: 1px solid #ccc;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
    }

    /* Style pour le fond semi-transparent */
    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 999;
    }
</style>

{% extends 'base.html' %}

{% block content %}
<a href="{% url 'gestion:create_message' %}" class="new-message-button">New Message</a>

<div class="message-list-filters">
    <!-- Ajoutez une barre de recherche pour filtrer par expéditeur (from) -->
    <form method="get" action="{% url 'gestion:messagerie' %}">
        <input type="text" name="from" placeholder="From" value="{{ request.GET.from }}">
        <button type="submit">Search</button>
    </form>

    <!-- Ajoutez une barre de recherche pour filtrer par ID -->
    <form method="get" action="{% url 'gestion:messagerie' %}">
        <input type="text" name="trading_number" placeholder="trading_number" value="{{ request.GET.trading_number }}">
        <button type="submit">Search</button>
    </form>

    <p>Filter by status:</p>
    <a href="{% url 'gestion:messagerie' %}" {% if not status_filter %}class="active"{% endif %}>All</a> |
    <a href="{% url 'gestion:messagerie' %}?status=unread" {% if status_filter == 'unread' %}class="active"{% endif %}>Unread</a> |
    <a href="{% url 'gestion:messagerie' %}?status=read" {% if status_filter == 'read' %}class="active"{% endif %}>Read</a> |
    <a href="{% url 'gestion:messagerie' %}?status=replied" {% if status_filter == 'replied' %}class="active"{% endif %}>Replied</a>
</div>


<div class="mailbox">
    <h2>Your Messages:</h2>
    
    <ul class="message-list">
        <table class="message-table">
            <tr>
                <th>From</th>
                <th>To</th>
                <th>Subject</th>
                <th>Status</th>
                <th>Tranding Number</th>
                <th>Date</th>
                <th>ID</th>
                <th></th>
                <th><a href="#" class="delete-selection" id="delete-selected">Delete Selection</a></th>
              
                <th>Select All<input type="checkbox" id="select-all-checkbox"></th> <!-- Checkbox pour sélectionner tout -->
            
            </tr>
            {% for message in messages %}
           
            <tr class="message-row {% if message.status == 'non lus' %}unread-message{% endif %}" onclick="window.location.href='{% url 'gestion:message_detail' messagerie_id=message.id %}'">
                <td>{{ message.sender }}</td>
                <td>{{ message.buyer }}</td>
                <td>{{ message.subject }}</td>
                <td>{{ message.status }}</td>
                <td>{{ message.trading_number }}</td>
                <td>{{ message.date }}</td>
                <td>{{ message.id }}</td>
                <td><a href="{% url 'gestion:confirm_delete_message' message_id=message.id %}" class="delete-button" onclick="return confirmDelete(this);"> Delete</a></td>
                <td><input type="checkbox" name="selected_messages" value="{{ message.id }}" onclick="event.stopPropagation();"></td>
                

               
                


                

            </tr>
            

            {% endfor %}
        </table>
    </ul>

</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const selectAllCheckbox = document.getElementById("select-all-checkbox");
        const messageCheckboxes = document.querySelectorAll('input[name="selected_messages"]');
    
        selectAllCheckbox.addEventListener("change", function () {
            messageCheckboxes.forEach(function (checkbox) {
                checkbox.checked = selectAllCheckbox.checked;
            });
        });
    });
    </script>


{% endblock %}